# 计算机组成原理

## 计算机的基本组成

![](https://img.misaka.gq/Notes/subject/计算机组成原理/计算机结构框图.png)

|部件|功能|
|:---:|:---:|
|运算器|负责数据的算术运算和逻辑运算即数据的加工处理,并将运算的中间结果暂存在运算器中|
|存储器|实现记忆功能的部件用来存放计算程序及参与运算的各种数据|
|控制器|负责对程序规定的控制信息进行分析,控制并协调输入,输出操作或内存访问|
|输入设备|实现计算程序和原始数据的输入|
|输出设备|实现计算结果输出|

**运算器**和**控制器**往往集成在同一芯片上,统称为**中央处理器**,把输入设备和输出设备简称为**I/O设备**

现代计算机可认为由三大部分组成:**CPU**,**I/O设备**,**主存储器**

**算术逻辑单元**`ALU`用于完成算术逻辑运算,**控制单元**`CU`用来解释存储器中的指令,并发出各种操作命令来执行指令

![](https://img.misaka.gq/Notes/subject/计算机组成原理/ALU_CU.png)

---

![](https://img.misaka.gq/Notes/subject/计算机组成原理/细化的计算机组成框图.png)

- 主存储器

主存储器简称主存或内存

存储体由多个**存储单元**组成,一个存储单元可以存储一串二进制代码,称为一个**存储字**,存储字的位数称为**存储字长**

主存的工作方式是按照存储单元的地址号来实现对存储字各位的读写(按地址访问存储器)

`MAR`是存储器地址寄存器,用来存放要访问的存储单元的地址,其**位数对应存储单元的个数**(10位MAR,则有2^10=1024个存储单元)

`MDR`是存储器数据寄存器,用来存放从存储体某单元取出的数据或者准备往某单元存放的数据,其**位数与存储字长相等**

随着技术的发展,`MAR`与`MDR`被集成在CPU中,指令字长和数据字长也可变,存储字长,指令字长,数据字长可以不同,但必须是字节的整数倍

- 运算器

运算器最少包含3个寄存器和一个算术逻辑单元,`ACC`为累加器,`MQ`为乘商寄存器,`X`为操作数寄存器

- 控制器

取指->分析->执行

控制器由程序计数器`CU`,指令寄存器`IR`,控制单元`CU`组成,`PC`用来存放当前要执行的指令的**地址**(与`MAR`相连接),`PC`能自动生成下一条指令的地址,`IR`存放当前指令,`IR`的内容来自`MDR`,`IR`中的指令发送至`CU`,进行指令分析

---

1. 机器字长

机器字长是指CPU一次能处理数据的位数

2. 存储容量

存储器的容量应该包括主存容量和辅存容量

主存容量=存储单元个数(MAR的位数)x存储字长(MDR的位数)

MAR=16,MDR=32,2^16个存储单元,容量=2^16*32=2^21bits=256KB

辅存容量用字节数表示

## 系统总线

总线将计算机的两个或多个功能单元连接在一起并允许它们相互交换数据

![](https://img.misaka.gq/Notes/subject/计算机组成原理/总线.png)

图1-17表示分散连接,如果要新增一个单元,就必须把这个单元与其要连接的每一个单元间新增一条连线

图1-18所示互连结构的问题在于,每次只有位移一个设备能够与其他设备通信,因为只有一条信息通路,如果两个设备同时请求使用总线,它们要竞争总线的控制权

!>总线术语

1. 宽度

一般用并行数据通路的数量来定义总线的宽度,一条64位宽的总线一次能够传送64位信息(8个字节)

2. 带宽

总线带宽是衡量信息在总线上的传输速率的一项指标,带宽的单位为`B/s`或`b/s`,在保持数据传输率不变的情况下增加总线的宽度,可以调高带宽

3. 延迟

延迟是从发出数据传输请求到实际数据传输的时间间隔

|总线分类|信息类型|内容|
|:---:|:---:|:---:|
|地址总线|地址信息|存储单元的地址|
|控制总线|控制信息|器件的选择,读或写的命令|
|数据总线|数据信息|读或写的数据|

1. 地址总线

CPU通过地址总线来指定存储单元,**地址总线的宽度决定了CPU的寻址能力**

一个CPU有N根地址线,则CPU最多可以寻找2^N个内存单元

>一个具有16根地址线的CPU,可以寻址2^16=65536Byte=64KB内存

2. 数据总线

CPU与其他器件之间的数据传送通过数据总线进行,**数据总线的宽度决定了CPU与其他器件进行数据传送时的一次数据传送量**

8根数据总线一次可以传送一个8位2进制数据(8bits=1Byte),即一个字节

>8086的数据总线宽度位16根(一次传输2Byte数据),从内存中读取1024字节的数据,至少要读512次

3. 控制总线

CPU对外部器件的控制通过控制总线进行,**控制总线的宽度决定了CPU对系统中其他器件的控制能力**

!>总线特性

- 机械特性
- 电气特性
- 功能特性
- 时间特性

### 总线结构

#### 单总线结构

![](https://img.misaka.gq/Notes/subject/计算机组成原理/单总线结构.png)

所有数据的传输都通过这组共享总线,因此极易造成计算机系统的瓶颈,同时其不允许两个以上的部件在同一时间相总线传输信息,当I/O量较大时,会产生极大的延迟

#### 多总线结构

- 双总线结构

![](https://img.misaka.gq/Notes/subject/计算机组成原理/双总线结构.png)

将速度较低的I/O设备从单总线上分离,形成主存总线与I/O总线分离的结构

- 三总线结构

![](https://img.misaka.gq/Notes/subject/计算机组成原理/三总线结构.png)

主存总线用于CPU与主存之间的传输,I/O总线供CPU与各类I/O设备之间传递信息,**DMA总线**用于告诉I/O设备与主存之间直接交还信息

任一时刻只能使用一种总线,主存总线与DMA总线不能同时对主存进行存取

- 四总线结构

![](https://img.misaka.gq/Notes/subject/计算机组成原理/四总线结构.png)

### 总线控制

#### 总线判优控制

![](https://img.misaka.gq/Notes/subject/计算机组成原理/总线判优控制.png)

>BS总线忙,BR总线请求,BG总线同意

1. 链式查询

容易扩充设备,但对电路故障敏感,离总线控制部件越近的设备具有越高的优先级

2. 计数器定时查询

计数器的开始顺序可以调整并循环,因此各个设备的总线优先级可以相等

3. 独立请求

每一台设备均有一对总线请求线和总线同意线,当设备要使用总线时,发出该设备的请求信号,排队电路根据优先次序对请求作出响应,响应速度快,优先次序控制灵活

链式查询中仅用两根线确定总线使用权属于哪个设备,计数器查询要用$log_{2}n$根线,而独立请求要用`2n`根线

## 存储器

### 存储器分类

1. 按存储介质分类

- 半导体存储器
- 磁表面存储器
- 磁芯存储器
- 光盘存储器

2. 按存取方式分类

- 随机存储器RAM

RAM分为静态RAM(以触发器原理寄存信息)和动态RAM(以电容充放电原理寄存信息)

- 只读存储器ROM

    - 掩模型只读存储器`MROM`
    - 可编程只读存储器`PROM`
    - 可擦除可编程只读存储器`EPROM`
    - 电擦除可编程只读存储器`EEPROM`

![](https://img.misaka.gq/Notes/subject/计算机组成原理/存储器分类.png)

#### 存储器的层次结构

寄存器的速度,容量,每位价格的比较

寄存器>>缓存>>主存>>磁盘>>磁带

![](https://img.misaka.gq/Notes/subject/计算机组成原理/两个层次.png)

存储系统层次结构主要体现在**缓存-主存**和**主存-辅存**两个存储层次上

缓存-主存层次主要解决了CPU和主存速度不匹配的问题

主存-辅存层次主要解决了存储系统的容量问题

### 主存储器

![](https://img.misaka.gq/Notes/subject/计算机组成原理/主存的基本组成.png)

!>驱动器,译码器和读写电路在存储芯片中,MAR和MDR在CPU中,两者通过总线连接

![](https://img.misaka.gq/Notes/subject/计算机组成原理/CPU与主存.png)

当要从存储器中读取某一信息字时,首先由CPU将该字的地址送到MAR,经地址总线送到主存,发出读指令

主存接到读指令后,将该单元的内容读取到数据总线上,MDR决定该信息送到什么地方

当要向主存存入一个信息字时,MAR通过地址总线传送所在主存单元的地址,将信息字送入MDR,向主存发出写指令,主存将数据总线上的信息写书地址总线指出的内存单元中

