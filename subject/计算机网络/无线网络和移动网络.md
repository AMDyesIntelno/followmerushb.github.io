### IEEE 802.11

802.11就是无线以太网的标准,它使用星形拓扑,其中心叫做接入点AP,在MAC层使用`CSMA/CA`协议

802.11标准规定无线局域网的最小构件是**基本服务集BSS**,一个基本服务集BSS包括一个基站和若干个移动站,所有的站在本BSS以内都可以直接通信,但在和本BSS以外的站通信时都必须通过本BSS的基站

当网络管理员安装AP时,必须为该AP分配一个不超过`32`字节的服务集标识符`SSID`和一个通信信道,SSID其实就是指使用该AP的无线局域网的名字,一个基本服务集BSS所覆盖的地理范围叫做一个**基本服务区BSA**

---

一个移动站若要加入到一个基本服务集BSS,就必须先选择一个接入点AP,并与此接入点建立关联

建立关联就表示这个移动站加入了选定的AP所属的子网,并和这个AP之间创建了一个虚拟线路

只有关联的AP才能向这个移动站发送数据帧,而这个移动站也只有通过关联的AP才能向其他站点发送数据帧

若移动站使用重建关联服务,就可把这种关联转移到另一个接入点

当使用分离服务时,就可终止这种关联

---

移动站与AP建立关联的方法

- 被动扫描:移动站等待接收接入站周期性发出的**信标帧**,信标帧中包含有若干系统参数(如SSID)

- 主动扫描:移动站主动发出**探测请求帧**,然后等待从AP发回的**探测响应帧**

---

热点就是公众无线入网点,由许多热点和 AP 连接起来的区域叫做热区

用户可以通过无线信道接入到无线互联网服务提供者,然后再经过无线信道接入到互联网

---

初期的接入加密方案称为`WEP`,意思是有线等效的保密

现在的接入加密方案为`WPA`或`WPA2`

### 802.11 物理层

![](https://cdn.jsdelivr.net/gh/followmerushb/followmerushb.github.io@master/static/subject/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/802.11物理层.jpg)

>OFDM代表正交频分复用,MIMO代表多入多出,使用多空间通道,对不同数据进行不同的调制/解调,因而提高了数据的传输速率

### 802.11 链路层

1. 隐蔽站问题

![](https://cdn.jsdelivr.net/gh/followmerushb/followmerushb.github.io@master/static/subject/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/隐蔽站问题.jpg)

站点A和C都想和B通信,但A和C相距较远,彼此都听不见对方,当A和C检测到信道空闲时,就都向B发送数据,结果发生了碰撞

2. 暴露站问题

![](https://cdn.jsdelivr.net/gh/followmerushb/followmerushb.github.io@master/static/subject/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/暴露站问题.jpg)

站点B向A发送数据,而C又想和D通信,但C检测到信道忙,于是就不敢向D发送数据,其实B向A发送数据并不影响C向D发送数据

因此`CSMA/CA`协议需要具有碰撞避免的功能

802.11的MAC层具有协调功能,用于确认在BSS中的移动站,什么时候能够发送或接收数据

![](https://cdn.jsdelivr.net/gh/followmerushb/followmerushb.github.io@master/static/subject/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/802.11MAC层.jpg)

1. 分布协调功能DCF,DCF不采用任何中心控制,而是在每一个结点使用CSMA机制的分布式接入算法,让各个站通过争用信道来获取发送权

2. 点协调功能PCF,PCF是选项,是用接入点AP集中控制整个BSS内的活动,因此自组网络就没有PCF子层,PCF使用集中控制的接入算法,用类似于探询的方法把发送数据权轮流交给各个站,从而避免了碰撞的产生

为了尽量避免碰撞,802.11规定,所有的站在完成发送后,必须等待一段很短的时间(继续监听)才能发送下一帧,这段时间通称为**帧间间隔**`IFS`

>帧间间隔的长短取决于该站要发送的帧的类型,高优先级帧需要等待的时间较短,因此可优先获得发送权,但低优先级帧就必须等待较长的时间,若低优先级帧还没来得及发送而其他站的高优先级帧已发送到媒体,则媒体变为忙态,低优先级帧只能再推迟发送,这样就减少了发生碰撞的机会

![](https://cdn.jsdelivr.net/gh/followmerushb/followmerushb.github.io@master/static/subject/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/CSMACA工作原理.jpg)

SIFS,即短帧间间隔,长度为28µs,SIFS是最短的帧间间隔,用来分隔开属于一次对话的各帧,在这段时间内,一个站应当能够从发送方式切换到接收方式

DIFS,即分布协调功能帧间间隔,长度为128µs,在DCF方式中,DIFS用来发送数据帧和管理帧

![](https://cdn.jsdelivr.net/gh/followmerushb/followmerushb.github.io@master/static/subject/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/退避机制.jpg)

>若站点最初有数据要发送(而不是发送不成功再进行重传),且检测到信道空闲,在等待时间DIFS后,就发送整个数据帧
>
>否则,站点执行CSMA/CA协议的退避算法,一旦检测到信道忙,就冻结退避计时器,只要信道空闲,退避计时器就进行倒计时
>
>当退避计时器时间减少到零时(这时信道只可能是空闲的),站点就发送整个的帧并等待确认
>
>发送站若收到确认,就知道已发送的帧被目的站正确收到了,这时如果要发送第二帧,就要从上面的步骤(2)开始,执行CSMA/CA协议的退避算法,随机选定一段退避时间

当一个站要发送数据帧时,仅在下面的情况下才不使用退避算法:检测到信道是空闲的,并且这个数据帧是它想发送的第一个数据帧

以下几种情况必须使用退避算法:

- 在发送第一个帧之前检测到信道处于忙态

- 每一次的重传

- 每一次的成功发送后再要发送下一帧

![](https://cdn.jsdelivr.net/gh/followmerushb/followmerushb.github.io@master/static/subject/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/802.11帧格式.jpg)

- MAC首部,共`30`字节

- 帧主体,也就是帧的数据部分,不超过2312字节

- 帧检验序列FCS是MAC尾部,共4字节