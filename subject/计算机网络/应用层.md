### 域名系统DNS

域名系统(英语:`Domain Name System`,缩写:`DNS`)是互联网的一项服务,它作为将域名和IP地址相互映射的一个分布式数据库,能够使人更方便地访问互联网,DNS使用TCP和UDP端口`53`

当前,对于每一级域名长度的限制是`63`个字符,域名总长度则不能超过`253`个字符(不区分大小写)

域名的结构由标号序列组成,各标号之间用点隔开

`xxx.三级域名.二级域名.顶级域名`

DNS系统中,常见的资源记录类型有:

1. 主机记录(A记录):RFC 1035定义,A记录是用于名称解析的重要记录,它将特定的主机名映射到对应主机的IP地址上
2. 别名记录(CNAME记录):RFC 1035定义,CNAME记录用于将某个别名指向到某个A记录上,这样就不需要再为某个新名字另外创建一条新的A记录
3. IPv6主机记录(AAAA记录):RFC 3596定义,与A记录对应,用于将特定的主机名映射到一个主机的IPv6地址
4. 域名服务器记录(NS记录) :用来指定该域名由哪个DNS服务器来进行解析,如`ns1.domain.com`,`ns2.domain.com`,NS记录是指定由哪个DNS服务器解析你的域名

在未缓存的DNS查询期间,每当用户在浏览器中输入网址,该操作都会触发DNS查找,并且所有DNS查找都从**根区域**开始,查找到达根区域后,将沿DNS系统的层次结构向下移动,首先到达TLD服务器(顶级域名服务器
),然后到达特定域的服务器,直到最终到达权威性名服务器,以查到正确的域名,其中包含要搜索的网站的IP地址,该IP地址被返回给客户端

有`13`个不同的IP地址为DNS根区域提供服务,并且全球有数百个冗余根服务器来处理对根区域的请求

#### 递归查询与迭代查询

- 主机向本地域名服务器的查询一般都是采用递归查询

所谓递归查询就是:如果主机所询问的本地域名服务器不知道被查询的域名的IP地址,那么本地域名服务器就以DNS客户的身份,向其它根域名服务器继续发出查询请求报文(即替主机继续查询),而不是让主机自己进行下一步查询

因此,递归查询返回的查询结果或者是所要查询的IP地址,或者是报错,表示无法查询到所需的IP地址

- 本地域名服务器向根域名服务器的查询是迭代查询

迭代查询的特点:当根域名服务器收到本地域名服务器发出的迭代查询请求报文时,要么给出所要查询的IP地址,要么告诉本地服务器:"你下一步应当向哪一个域名服务器进行查询"

然后让本地服务器进行后续的查询,根域名服务器通常是把自己知道的顶级域名服务器的IP地址告诉本地域名服务器,让本地域名服务器再向顶级域名服务器查询

顶级域名服务器在收到本地域名服务器的查询请求后,要么给出所要查询的IP地址,要么告诉本地服务器下一步应当向哪一个权限域名服务器进行查询

最后,知道了所要解析的IP地址或报错,然后把这个结果返回给发起查询的主机

#### DNS查找的8个步骤

1. 用户在Web浏览器中键入`example.com`,查询传输到Internet中,并被DNS递归解析器接收
2. 接着,解析器查询DNS根域名服务器`.`
3. 然后,根服务器使用存储其域信息的顶级域(TLD)DNS服务器(例如`.com`或`.net`)的地址响应该解析器在搜索`example.com`时,我们的请求指向`.com`TLD
4. 然后,解析器向`.com`TLD发出请求
5. TLD服务器随后使用该域的域名服务器`example.com`的IP地址进行响应
6. 最后,递归解析器将查询发送到域的域名服务器
7. `example.com`的IP地址而后从域名服务器返回解析器
8. 然后DNS解析器使用最初请求的域的IP地址响应Web浏览器

DNS查找的这8个步骤返回`example.com`的IP地址后,浏览器便能发出对该网页的请求:

9. 浏览器向该IP地址发出HTTP请求
10. 位于该IP的服务器返回将在浏览器中呈现的网页

![](https://cdn.jsdelivr.net/gh/followmerushb/followmerushb.github.io@master/static/subject/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/dns-lookup-diagram.webp)

### 文件传输协议FTP

FTP服务一般运行在`20`和`21`两个端口,端口`20`用于在客户端和服务器之间传输数据流,而端口`21`用于传输控制流,并且是命令通向ftp服务器的进口

### 统一资源定位符URL

统一资源定位符(英语:`Uniform Resource Locator`,缩写:`URL`,俗称网页地址或简称网址)是因特网上标准的资源的地址,如同在网络上的门牌

统一资源定位符的标准格式如下:

`[协议类型]://[服务器地址]:[端口号]/[资源层级UNIX文件路径][文件名]?[查询]#[片段ID]`

超文本传输协议的统一资源定位符将从因特网获取信息的五个基本元素包括在一个简单的地址中:

1. 传送协议
2. 层级URL标记符号(为`//`,固定不变)
3. 访问资源需要的凭证信息(可省略)
4. 服务器(通常为域名,有时为IP地址)
5. 端口号(以数字方式表示,若为默认值可省略)
6. 路径(以`/`字符区别路径中的每一个目录名称)
7. 查询(GET模式的窗体参数,以`?`字符为起点,每个参数以`&`隔开,再以`=`分开参数名称与资料,通常以UTF8的URL编码,避开字符冲突的问题)
8. 片段以`#`字符为起点

以`https://zh.wikipedia.org:443/w/index.php?title=Special:随机页面`为例,其中:

1. `https`,是协议
2. `zh.wikipedia.org`,是服务器
3. `443`,是服务器上的网络端口号
4. `/w/index.php`,是路径
5. `?title=Special:随机页面`,是询问

### 超文本传送协议HTTP

#### 主要特点

HTTP使用了面向连接的TCP作为运输层协议,保证了数据的可靠传输

HTTP协议本身也是无连接的,虽然它使用了面向连接的TCP向上提供的服务

HTTP是面向事务的客户服务器协议

HTTP 1.0协议是无状态的

#### 状态码

- 1xx消息:请求已被服务器接收,继续处理

- 2xx成功:请求已成功被服务器接收,理解,并接受

- 3xx重定向:需要后续操作才能完成这一请求

- 4xx请求错误:请求含有词法错误或者无法被执行

- 5xx服务器错误:服务器在处理某个正确请求时发生错误

#### 请求信息

发出的请求信息(message request)包括以下几个:

- 请求行(例如`GET /images/logo.gif HTTP/1.1`,表示从`/images`目录下请求`logo.gif`这个文件)
- 请求头(例如`Accept-Language: en`)
- 空行
- 其他消息体

请求行和标题必须以`<CR><LF>`作为结尾,空行内必须只有`<CR><LF>`而无其他空格

在HTTP/1.1协议中,所有的请求头,除Host外,都是可选的

##### 客户端请求

```
GET / HTTP/1.1
Host: www.google.com

```

(末尾有一个空行,第一行指定方法,资源路径,协议版本,第二行是在1.1版里必带的一个header作用于指定主机)

##### 服务器应答

```
HTTP/1.1 200 OK
Content-Length: 3059
Server: GWS/2.0
Date: Sat, 11 Jan 2003 02:44:04 GMT
Content-Type: text/html
Cache-control: private
Set-Cookie: PREF=ID=73d4aef52e57bae9:TM=1042253044:LM=1042253044:S=SMCc_HRPCQiqy
X9j; expires=Sun, 17-Jan-2038 19:14:07 GMT; path=/; domain=.google.com
Connection: keep-alive

```

### 简单邮件传输协议SMTP

简单邮件传输协议(英语:`Simple Mail Transfer Protocol`,缩写:`SMTP`)是一个在互联网上传输电子邮件的标准

!>SMTP使用`TCP`端口`25`,要为一个给定的域名决定一个SMTP服务器,需要使用DNS的MX记录

### 动态主机配置协议DHCP

DHCP基于`UDP`工作,DHCP服务器运行在`67`号端口,DHCP客户运行在`68`号端口