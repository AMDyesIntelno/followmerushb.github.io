?>《计算机网络 自顶向下方法》&《计算机网络》

![](https://cdn.jsdelivr.net/gh/AMDyesIntelno/blog_img/Notes/books/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/TCP_IP.png)

## 第一部分 计算机网络和因特网

|术语|name|简称|
|:---:|:---:|:---:|
|主机|host|
|端系统|end system|
|因特网服务提供商|Internet Service Provider|ISP|
|传输控制协议|Transmission Control Protocol|TCP|
|网际协议|Internet Protocol|IP|
|套接字|socket|
|客户端|client|
|服务器|server|
|数字用户线|Digital Subscriber Line|DSL|
|电缆因特网接入|cable Internet access|
|调制解调器|modem|
|光纤入户|Fiber To The Home|FTTH|
|无屏蔽双绞线|Unshielded Twisted Pair|UTP|
|丢包|packet loss|
|电路交换|circuit switching|
|分组交换|packet switching|
|频分复用|Frequency-Division Multiplexing|FDM|
|时分复用|Time-Division Multiplexing|TDM|
|多宿|multi-home|
|互联网交换点|Internet eXchange Point|IXP|

### 单位换算

1 Mbps=1000 **kbps**

1 Mbps=125 **kBps**

数据传输时单位K是表示十进制,数据存储时单位K是表示2进制

### 分组交换

大部分分组交换机在链路的输入端采用**存储转发传输**

>存储转发传输指的是在交换机能够开始向输出链路传输该分组的第一个比特之前必须接收到整个分组

分组交换比电路交换的电路利用率高,比报文交换的传输时延小,交互性好

!>每个分组在互联网中独立地选择传输路径,路径可能不同

- 分组交换的优点

1. 高效:在分组传输的过程中动态分配传输带宽,对通信链路是逐段占用

2. 灵活为每一个分组独立地选择最合适的转发路由

3. 迅速:以分组作为传送单位,可以不先建立连接就能向其他主机发送分组

4. 可靠:保证可靠性的网络协议,分布式多路由的分组交换网,使网络有很好的生存性

- 分组交换的缺点

1. 排队

2. 延时

3. 首部的开销

4. 丢包

### 电路交换

电路交换例子:传统电话网

电路交换要求必须首先在通信双方之间建立连接通道

在连接建立成功之后,双方的通信活动才能开始

通信双方需要传递的信息都是通过已经建立好的连接来进行传递的,而且这个连接也将一直被维持到双方的通信结束

电路交换可以`频分复用`和`时分复用`

优点:实时性强,时延小,交换设备成本较低

缺点:线路利用率低,电路接续时间长,通信效率低,不同类型终端用户之间不能通信

电路交换比较适用于信息量大,长报文,经常使用的固定用户之间的通信

#### 频分复用

链路中的频谱有跨域链路创建的所有链接共享

在链接期间,链路为每一条链接专用一个频段

频段的宽度称为**带宽**

#### 时分复用

对于TDM链路,时间被划分为固定期间的帧,每一个帧被划分为固定数量的时隙

当网络跨越一条链路创建一条链接时,网络在每一个帧中为该链接指定一个时隙,这些时隙专门由该链接单独使用

>电路交换网络在实时服务的情况下,要比分组网络有优势,因为分组网络的端到端时延是可变和不可预测的
>
>TDM的优势在于在当发生拥塞等网络问题时, TDM 中的数据丢失可能只会是一部分,而FDM 中就可能是大部分或全部

### 带宽

>带宽有以下两种不同的意义

- 某个信号具有的频带宽度

信号的带宽是指该信号所包含的各种不同频率成分所占据的频率范围

例如:在传统的通信线路上传送的电话信号的标准带宽是3.1kHz(从300Hz到3.4kHz,即话音的主要成分的频率范围)

这种意义的带宽的单位是赫(或千赫,兆赫,吉赫等),在过去很长的一段时间,通信的主干线路传送的是模拟信号(即连续变化的信号)

因此,表示某信道允许通过的信号频带范围就称为该信道的带宽(或通频带)

- 网络中某通道传送数据的能力

网络带宽表示在单位时间内网络中的某信道所能通过的"最高数据率"

这种意义的带宽的单位就是数据率的单位bit/s,是"比特每秒"

>在"带宽"的上述两种表述中,前者为频域称谓,而后者为时域称谓,其本质是相同的,也就是说,一条通信链路的"带宽"越宽,其所能传输的"最高数据率"也越高

### 节点总时延

节点总时延=节点处理时延+排队时延+传输时延+传播时延

除了排队时延可变之外,其他时延都是固定的

传输时延:

将**所有分组**中的比特推向链路所需的时间

`用L(bit)表示该分组的长度,用R(bps)表示链路传输速度,传输时延=L/R`

传播时延: 

当一个比特被推向链路后,该比特向下一个节点传播

从该链路起点到下一个节点传播所需的时间为传播时延

传播时延可以理解为光在该链路上的传播时间

`用d表示链路起点到下一个节点的距离,传播时延=d/光速`

对于一条链路,如果到达速率超过了链路的带宽(传输速率),并保持一定时间,则会发生拥塞:

- 分组将在路由的缓存中进行排队,等待发送进入链路(排队时延)

- 如果路由的缓存已满,则分组可能会被丢弃,信息可能会丢失(丢包)

### 吞吐量

吞吐量表示在单位时间内通过某个网络(或信道,接口)的数据量,吞吐量受网络的带宽或网络的额定速率的限制

假定从主机A到主机B通过网络传递某个文件,在任何时间瞬间的**瞬时吞吐量**是主机B接收到该文件的速率

如果该文件由F比特组成,主机B接收到所有F比特用去T秒,则文件传送的**平均吞吐量**是`F/T`bps

---

假定服务器与客户端之间通过两条通信链路和一台路由器相连,设`Rs`为服务器与路由器之间的链路速率,`Rc`为路由器与客户端之间的链路速率

显然,服务器到客户端的速率不能超过`min(Rs,Rc)`,服务器到客户端的吞吐量是`min(Rs,Rc)`,这称为**瓶颈链路**的传输速率

---

假定服务器与客户端之间通过`N`条通信链路和`N-1`台路由器相连,传输速率分别为`R1,R2,R3...`

服务器到客户端的文件传输吞吐量为`min(R1,R2,R3...)`

### 带宽时延乘积

在数据通信中,带宽时延乘积(bandwidth-delay product)指的是一个数据链路的能力(每秒比特)与来回通信延迟(单位秒)的乘积

带宽时延乘积=传播时延*带宽

其结果是以比特(或字节)为单位的一个数据总量,等同在任何特定时间该网络线路上的最大数据量(已发送但尚未确认的数据)

### 往返时间RTT

>在双方通信中,发讯方的信号传播到收讯方的时间(传播延迟),加上收讯方回传消息到发讯方的时间(如果没有造成双向传播速率差异的因素,此时间与发讯方将信号传播到收讯方的时间一样久) 

>A向B发送数据,如果数据长度是100MB,发送速率是100Mbit/s

发送时间=数据长度/发送速率=(100\*2^20\*8)/(100*10^6)=8.39s

>如果B正确收完100MB的数据后,就立即向A发送确认,再假定A只有在收到B的确认信息后,才能继续向B发送数据
>
>显然,这需要等待一个往返时间RTT,如果RTT＝2s,那么可以算出A向B发送数据的有效数据率

有效数据率=数据长度/(发送时间+RTT)=(100\*2^20*8)/(8.39+2)=80.7Mbit/s

### 利用率

>利用率有信道利用率和网络利用率两种
>
>信道利用率指出某信道有百分之几的时间是被利用的(有数据通过)完全空闲的信道的利用率是零
>
>网络利用率则是全网络的信道利用率的加权平均值
>
>信道利用率并非越高越好,当某信道的利用率增大时,该信道引起的时延也就迅速增加
>
>当网络的通信量很少时,网络产生的时延并不大,但在网络通信量不断增大的情况下,由于分组在进行处理时需要排队等候,因此网络引起的时延就会增大
>
>如果令D0表示网络空闲时的时延,D表示网络当前的时延,那么在适当的假定条件下,可以用公式来表示D,D0和利用率U之间的关系

D=D0/(1-U)

>U是网络的利用率,数值在0到1之间
>
>当网络的利用率达到其容量的1/2时,时延就要加倍,当网络的利用率接近最大值1时,网络的时延就趋于无穷大
>
>因此信道或网络的利用率过高会产生非常大的时延

### 协议栈

|5层因特网协议栈|7层OSI模型|
|:---:|:---:|
|应用层(报文)|应用层|
|传输层(报文段)|~~表示层~~|
|网络层(数据报)|~~会话层~~|
|链路层(帧)|传输层|
|物理层|网络层|
||链路层|
||物理层|

#### 应用层(application layer)

>应用层是体系结构中的最高层
>
>应用层的任务是通过应用进程间的交互来完成特定网络应用
>
>应用层协议定义的是应用进程间通信和交互的规则
>
>应用层交互的数据单元称为报文(message)

#### 传输层(transport layer)

>传输层的任务就是负责向两台主机中进程之间的通信提供通用的数据传输服务
>
>应用进程利用该服务传送应用层报文,由于一台主机可同时运行多个进程,因此传输层有复用和分用的功能
>
>复用就是多个应用层进程可同时使用下面传输层的服务,分用和复用相反,是传输层把收到的信息分别交付上面应用层中的相应进程

传输层主要使用以下两种协议：

- **传输控制协议** `TCP(Transmission Control Protocol)`--提供面向连接的,可靠的数据传输服务,其数据传输的单位是报文段(segment)

- **用户数据报协议** `UDP(User Datagram Protocol)`--提供无连接的数据传输服务(不保证数据传输的可靠性),其数据传输的单位是用户数据报

#### 网络层(network layer)

>网络层负责为分组交换网上的不同主机提供通信服务
>
>在发送数据时,网络层把传输层产生的报文段或用户数据报封装成分组或包进行传送
>
>在TCP/IP体系中,由于网络层使用IP协议,因此分组也叫做IP数据报,或简称为数据报

#### 数据链路层(data link layer)

>数据链路层常简称为链路层
>
>两台主机之间的数据传输,总是在一段一段的链路上传送的,这就需要使用专门的链路层的协议
>
>在两个相邻结点之间传送数据时,数据链路层将网络层交下来的IP数据报组装成帧(framing),在两个相邻结点间的链路上传送帧(frame)
>
>每一帧包括数据和必要的控制信息(如同步信息、地址信息、差错控制等)

#### 物理层(physical layer)

>在物理层上所传数据的单位是比特
>
>物理层为数据端设备提供传送数据通路并传输数据

#### 封装

在发送主机端,一个**应用层报文**被(应用要发送并传递到传输层的数据)传送到传输层,传输层收到报文并附上*传输层首部信息*,一并构成了**传输层报文段**

>**传输层报文段**封装了**应用层报文**

传输层向网络层传递该报文段,网络层收到报文段并附上*网络层首部信息*,生成了**网络层数据报**

>**网络层数据报**封装了**传输层报文段**

网络层向链路层传递该数据报,链路层收到数据报并附上*链路层首部信息*,生成了**链路层帧**

>**链路层帧**封装了**网络层数据报**

在每一层,一个分组具有两个类型的字段:**首部字段**和**有效载荷字段**

### 习题

1. 试在下列条件下比较电路交换和分组交换

要传送的报文共x(bit),从源点到终点共经过k段链路,每段链路的传播时延为d(s),数据率为b(bit/s)

在电路交换时电路的建立时间为s(s),在分组交换时分组长度为p(bit),且各结点的排队等待时间可忽略不计

问在怎样的条件下,分组交换的时延比电路交换的要小?

---

电路交换总时延=`k*d(总的传播时延)+x/b(传输时延)+s(电路建立时间)`

分组交换总时延=`k*d(总的传播时延)+x/b(传输时延)+(p/b)*(k-1)(最后一个分组离开源点,经过k-1个路由器的转发处理,最终到达终点所需的时间)`

当`s>(p/b)*(k-1)`时,分组交换的时延比电路交换的要小

---

2. 在上题的分组交换网中,设报文长度和分组长度分别为x和(p＋h)(bit),其中p为分组的数据部分的长度,而h为每个分组所带的控制信息固定长度,与p的大小无关

通信的两端共经过k段链路,链路的数据率为b(bit/s),但传播时延和结点的排队时间均可忽略不计

若打算使总的时延为最小,问分组的数据部分长度p应取为多大?

---

分组交换总时延=`(x/p)*((p+h)/b)+(p+h)/b*(k-1)`

求导,得`(-x/p*p)*((p+h)/b)+(x/p+k-1)/b=0`,当`p=(x*h/(k-1))^0.5`时,总的时延为最小

---

3. 假定网络的利用率达到了90%,试估算一下现在的网络时延是它的最小值的多少倍

---

`D=D0/(1-U)`,此时`U=0,D=D0`

`D=D0/(1-0.9)`,此时`U=0.9,D=0.1*D0`

时延是最小值的10倍

---

4. 假定有x名用户共享一条链路,每个用户在某时刻正在传输的概率为p(0<p<1),求出在任何给定时刻,实际有n个用户在同时传输的概率

---

![](https://cdn.jsdelivr.net/gh/AMDyesIntelno/blog_img@master/Notes/books/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/prac1-4.png)

## 第二部分 物理层

### 基础知识

一个数据通信系统可划分为三大部分,即**源系统**(或发送端、发送方),**传输系统**(或传输网络)和**目的系统**(或接收端,接收方)

---

源系统一般包括以下两个部分：

- 源点(source):源点设备产生要传输的数据,例如:从计算机的键盘输入汉字,计算机产生输出的数字比特流,源点又称为源站或信源

- 发送器:通常源点生成的数字比特流要通过发送器编码后才能够在传输系统中进行传输,典型的发送器就是**调制器**

目的系统一般也包括以下两个部分:

- 接收器:接收传输系统传送过来的信号,并把它转换为能够被目的设备处理的信息,典型的接收器就是**解调器**,它把来自传输线路上的模拟信号进行解调,提取出在发送端置入的消息,还原出发送端产生的数字比特流

- 终点(destination):终点设备从接收器获取传送来的数字比特流,然后把信息输出,终点又称为目的站,或信宿

---

通信的目的是传送**消息**(message),**数据**(data)是运送消息的实体,**信号**(signal)则是数据的电气或电磁的表现

根据信号中代表消息的参数的取值方式不同,信号可分为以下两大类:

- 模拟信号(连续信号):代表消息的参数的取值是连续的,调制解调器到电话端局之间的用户线上传送的就是模拟信号

- 数字信号(离散信号):代表消息的参数的取值是离散的,计算机到调制解调器之间,或在电话网中继线上传送的就是数字信号

在使用时间域(时域)的波形表示数字信号时,代表不同离散数值的基本波形就称为**码元**(一个码元所携带的信息量是不固定的,而是由调制方式和编码方式决定的)在使用二进制编码时,只有两种不同的码元,一种代表0状态而另一种代表1状态

---

**信道**一般都是用来表示向某一个方向传送信息的媒体,因此,一条通信电路往往包含一条发送信道和一条接收信道

- 单向通信(单工通信)即只能有一个方向的通信而没有反方向的交互,无线电广播或有线电广播以及电视广播属于这种类型

- 双向交替通信(半双工通信)即通信的双方都可以发送信息,但不能双方同时发送(当然也就不能同时接收)这种通信方式是一方发送另一方接收,过一段时间后可以再反过来

- 双向同时通信(全双工通信)即通信的双方可以同时发送和接收信息

单向通信只需要一条信道,而双向交替通信或双向同时通信则都需要两条信道(每个方向各一条),双向同时通信的传输效率最高

---

来自信源的信号常称为**基带信号**(基本频带信号)(计算机输出的代表各种文字或图像文件的数据信号都属于基带信号)

基带信号往往包含有较多的低频成分,甚至有直流成分,而许多信道并不能传输这种低频分量或直流分量,为了解决这一问题,就必须对基带信号进行**调制**(modulation)

调制可分为两大类

一类是仅仅对基带信号的波形进行变换,使它能够与信道特性相适应,变换后的信号仍然是基带信号,这类调制称为**基带调制**

由于这种基带调制是把数字信号转换为另一种形式的数字信号,这种过程也被称为**编码**(coding)

另一类调制则需要使用**载波**(carrier)进行调制,把基带信号的频率范围搬移到较高的频段,并转换为模拟信号,这样就能够更好地在模拟信道中传输

经过载波调制后的信号称为**带通信号**(即仅在一段频率范围内能够通过信道),而使用载波的调制称为**带通调制**

- 基带调制方式

![](https://cdn.jsdelivr.net/gh/AMDyesIntelno/blog_img@master/Notes/books/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/modulation1.jpg)

1. 不归零制:正电平代表1,负电平代表0

2. 归零制:正脉冲代表1,负脉冲代表0

3. 曼彻斯特编码:位周期中心的**向上跳变**代表0,位周期中心的**向下跳变**代表1,也可反过来定义

4. 差分曼彻斯特编码:在每一位的中心处始终都有跳变,**位开始边界**有跳变代表0,而**位开始边界**没有跳变代表1

---

- 带通调制方式

![](https://cdn.jsdelivr.net/gh/AMDyesIntelno/blog_img@master/Notes/books/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/modulation2.jpg)

1. 调幅(AM)即载波的振幅随基带数字信号而变化,例如,0或1分别对应于无载波或有载波输出

2. 调频(FM)即载波的频率随基带数字信号而变化,例如,0或1分别对应于频率f1或f2

3. 调相(PM)即载波的初始相位随基带数字信号而变化,例如,0或1分别对应于相位0度或180度